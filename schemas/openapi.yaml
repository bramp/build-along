# data/openapi.yaml
openapi: 3.1.0
info:
  title: LEGO Instructions Data Model
  version: 1.0.0
  description: Shared data models for LEGO instructions between Python and Flutter applications.

components:
  schemas:
    PdfEntry:
      type: object
      description: Represents a single instruction PDF file.
      properties:
        url:
          type: string
          format: uri
          description: The URL to the PDF file.
        filename:
          type: string
          nullable: true
          description: The suggested filename for the PDF.
        filesize:
          type: integer
          format: int64
          nullable: true
          description: The size of the PDF file in bytes.
        filehash:
          type: string
          nullable: true
          description: SHA256 hash of the PDF file content, if available.
        preview_url:
          type: string
          format: uri
          nullable: true
          description: An optional URL for a preview image of the PDF.
        is_additional_info_booklet:
          type: boolean
          nullable: true
          description: Indicates if the PDF is an additional info booklet rather than the main instructions.
        sequence_number:
          type: integer
          nullable: true
          description: The sequence number of the PDF in a multi-part instruction set (e.g., 1 for 1/4).
        sequence_total:
          type: integer
          nullable: true
          description: The total number of PDFs in a multi-part instruction set (e.g., 4 for 1/4).
      required:
        - url

    InstructionMetadata:
      type: object
      description: Complete metadata for a LEGO set's instructions.
      properties:
        set:
          type: string
          description: The unique identifier for the LEGO set.
        locale:
          type: string
          description: The locale for the instructions (e.g., "en-US").
        name:
          type: string
          nullable: true
          description: The name of the LEGO set.
        theme:
          type: string
          nullable: true
          description: The theme of the LEGO set (e.g., "City", "Star Wars").
        age:
          type: string
          nullable: true
          description: The recommended age range for the set.
        pieces:
          type: integer
          nullable: true
          description: The number of pieces in the set.
        year:
          type: integer
          format: int32
          nullable: true
          description: The year the set was released.
        set_image_url:
          type: string
          format: uri
          nullable: true
          description: URL to an image of the LEGO set.
        pdfs:
          type: array
          items:
            $ref: '#/components/schemas/PdfEntry'
          default: []
          description: A list of PDF instruction entries for the set.
      required:
        - set
        - locale

    YearlyIndexSummary:
      type: object
      description: Metadata for a single year's index file.
      properties:
        year:
          type: integer
          format: int32
          description: The year of the index.
        count:
          type: integer
          description: The number of sets in the index.
        filesize:
          type: integer
          format: int64
          description: The size of the index file in bytes.
        filename:
          type: string
          description: The filename of the index file.
      required:
        - year
        - count
        - filesize
        - filename

    MainIndex:
      type: array
      items:
        $ref: '#/components/schemas/YearlyIndexSummary'
      description: A list of summaries for each yearly index.

    YearlyIndex:
      type: array
      items:
        $ref: '#/components/schemas/InstructionMetadata'
      description: A list of instruction metadata for a single year.
